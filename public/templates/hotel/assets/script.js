var forms = {};forms['id877']={options:{"api":{"isEnable":false,"url":"","method":"GET"},"btn":{"id":"FX7le","text":"\u0628\u0627 \u0645\u0646 \u062a\u0645\u0627\u0633 \u0628\u06af\u06cc\u0631\u06cc\u062f","type":"btn"},"result":{"isModal":true,"redirectAddress":"","messages":{"success":"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u0627\u0631\u0633\u0627\u0644 \u0634\u062f.","error":"\u062e\u0637\u0627\u06cc\u06cc \u062f\u0631 \u0627\u0631\u0633\u0627\u0644 \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0628\u0647 \u0648\u062c\u0648\u062f \u0622\u0645\u062f."}}}};function _createForOfIteratorHelper(a){if("undefined"==typeof Symbol||null==a[Symbol.iterator]){if(Array.isArray(a)||(a=_unsupportedIterableToArray(a))){var b=0,c=function(){};return{s:c,n:function n(){return b>=a.length?{done:!0}:{done:!1,value:a[b++]}},e:function e(a){throw a},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,e,f=!0,g=!1;return{s:function s(){d=a[Symbol.iterator]()},n:function n(){var a=d.next();return f=a.done,a},e:function e(a){g=!0,e=a},f:function f(){try{f||null==d["return"]||d["return"]()}finally{if(g)throw e}}}}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(c):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var addClass=function(a,b){a.className.includes(b)||(a.className=a.className.concat(" ".concat(b)))},removeClass=function(a,b){a.className.includes(b)&&(a.className=a.className.replace(" ".concat(b),""))},hasClass=function(a,b){return!!a.className.includes(b)},isEmailValid=function(a){return /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]+$/i.test(a)},persianToLatin=function(a){var b;return null===a||"undefined"==typeof a?a:(b=a.toString().replace(/۰/g,"0"),b=b.replace(/۱/g,"1"),b=b.replace(/۲/g,"2"),b=b.replace(/۳/g,"3"),b=b.replace(/۴/g,"4"),b=b.replace(/۵/g,"5"),b=b.replace(/۶/g,"6"),b=b.replace(/۷/g,"7"),b=b.replace(/۸/g,"8"),b=b.replace(/۹/g,"9"),b)},isNumberValid=function(a){return /^([0-9]+)$/.test(persianToLatin(a))},isPhoneValid=function(a){return /^09\d{9}$/.test(persianToLatin(a))},request=function(a,b){return fetch(a,b).then(function(a){if(200<=a.status&&300>a.status)return a;var b=new Error(a.statusText);throw b.res=a,b}).then(function(a){return 204===a.status||205===a.status?null:a.json()})},appendHtml=function(a,b){var c=document.createElement("div");for(c.innerHTML=b;0<c.children.length;)a.appendChild(c.children[0])},KEY_ESC=27,Modal=function(){function a(b){return _classCallCheck(this,a),this.options=b,this.id=Date.now(),this.icon={success:"https://assets.landik.ir/images/modal/modal-success.svg",error:"https://assets.landik.ir/images/modal/modal-error.svg"},this.onKeyUp=this.onKeyUp.bind(this),this.render(),this.bindEvents(),this.open(),this}return _createClass(a,[{key:"bindEvents",value:function bindEvents(){document.addEventListener("keyup",this.onKeyUp)}},{key:"onKeyUp",value:function onKeyUp(a){a.keyCode==KEY_ESC&&(this.close(),document.removeEventListener("keyup",this.onKeyUp))}},{key:"open",value:function open(){var a=document.getElementById(this.id);setTimeout(function(){return addClass(a,"modal--open")},10)}},{key:"close",value:function close(){var a=document.getElementById(this.id);removeClass(a,"modal--open"),setTimeout(function(){return a.parentNode.removeChild(a)},500)}},{key:"renderIcon",value:function renderIcon(){var a=this,b=function(){switch(a.options.status){case"success":return{path:a.icon.success,className:"modal-icon-success",alt:"\u0622\u06CC\u06A9\u0646 \u0645\u0648\u0641\u0642\u06CC\u062A"};case"error":return{path:a.icon.error,className:"modal-icon-error",alt:"\u0622\u06CC\u06A9\u0646 \u062E\u0637\u0627"};}return null}();return b?"\n\t\t\t<div class=\"modal-icon\">\n\t\t\t\t<img class=\"".concat(b.className,"\" src=\"").concat(b.path,"\" alt=\"").concat(b.alt,"\"/>\n\t\t\t</div>\n\t\t"):null}},{key:"renderBtns",value:function renderBtns(){var a=this.options.btns;return a&&a.length?"\n\t\t\t<div class=\"modal-btns\">\n\t\t\t\t".concat(a.map(function(a){var b=a.variant?a.variant:"contained",c=a.color?a.color:"primary";return"<button class=\"modal-btn modal-btn--".concat(b," modal-btn--").concat(c,"\">").concat(a.title,"</button>")}).join(""),"\n\t\t\t</div>\n\t\t"):null}},{key:"render",value:function render(){var a=this,b=this.options.title,c="\n\t\t\t<div class=\"modal\" id=\"".concat(this.id,"\">\n\t\t\t\t<div class=\"modal-wrap\">\n\t\t\t\t\t").concat(this.renderIcon(),"\n\t\t\t\t\t").concat(b&&"<div class=\"modal-title\">".concat(b,"</div>"),"\n\t\t\t\t\t").concat(this.renderBtns(),"\n\t\t\t\t</div>\n\t\t\t</div>");appendHtml(document.body,c),document.getElementById(this.id).querySelectorAll("button").forEach(function(b,c){b.onclick=a.options.btns[c].onClick})}}]),a}(),Form=function(){function a(b){_classCallCheck(this,a),this.form=b,this.inputs=b.querySelectorAll("input[type=\"text\"]"),this.errors=[],this.method=this.form.getAttribute("method").toUpperCase(),this.id=this.form.parentNode.getAttribute("id").substring(2),this.url="https://lead.landik.ir/api/leads/".concat(this.id,"/store"),this.options=forms[this.form.parentNode.getAttribute("id")].options,this.formBtn=this.form.querySelector(".form-btn"),this.messageType={CAE:"contact.already.exists"},this.message={required:"\u067E\u0631 \u06A9\u0631\u062F\u0646 \u0627\u06CC\u0646 \u0642\u0633\u0645\u062A \u0636\u0631\u0648\u0631\u06CC \u0627\u0633\u062A",email:"\u0644\u0637\u0641\u0627\u064B \u06CC\u06A9 \u0627\u06CC\u0645\u06CC\u0644 \u0635\u062D\u06CC\u062D \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F",number:"\u0644\u0637\u0641\u0627\u064B \u06CC\u06A9 \u0639\u062F\u062F \u0635\u062D\u06CC\u062D \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F",phone:"\u0644\u0637\u0641\u0627\u064B \u06CC\u06A9 \u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06CC\u0644 \u0635\u062D\u06CC\u062D \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F",success:this.options.result.messages.success,error:_defineProperty({general:this.options.result.messages.error},this.messageType.CAE,"\u0634\u0645\u0627 \u0642\u0628\u0644\u0627 \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u0641\u0631\u0645 \u0628\u0627 \u0627\u06CC\u0646 \u0645\u0634\u062E\u0635\u0627\u062A \u0631\u0627 \u0627\u0631\u0633\u0627\u0644 \u06A9\u0631\u062F\u0647\u200C\u0627\u06CC\u062F.")},this.isAjax=!1,this.bindEvents()}return _createClass(a,[{key:"bindEvents",value:function bindEvents(){var a=this;this.form.addEventListener("submit",this.onSubmit.bind(this)),this.inputs.forEach(function(b){["input","focusout"].forEach(function(c){b.addEventListener(c,function(){return a.validate(b)})})})}},{key:"validate",value:function validate(a){var b=a.parentNode,c=a.value.trim(),d=a.getAttribute("name"),e=null!==a.getAttribute("required"),f=null!==a.getAttribute("email"),g=null!==a.getAttribute("number");e&&!c?(this.addHint(a,this.message.required),addClass(b,"form-field--error"),0>this.errors.indexOf(d)&&this.errors.push(d)):f&&!isEmailValid(c)&&c?(addClass(b,"form-field--error"),this.addHint(a,this.message.email),0>this.errors.indexOf(d)&&this.errors.push(d)):g&&!isPhoneValid(c)&&c?(addClass(b,"form-field--error"),this.addHint(a,this.message.phone),0>this.errors.indexOf(d)&&this.errors.push(d)):(removeClass(b,"form-field--error"),this.removeError(a))}},{key:"getFormData",value:function getFormData(a){var b,c=new FormData(a.target),d=_createForOfIteratorHelper(c.entries());try{for(d.s();!(b=d.n()).done;){var e=b.value;"phone"==e[0]&&c.set("phone",persianToLatin(e[1]))}}catch(a){d.e(a)}finally{d.f()}return c}},{key:"onSubmit",value:function onSubmit(a){var b=this;if(a.preventDefault(),this.inputs.forEach(function(a){return b.validate(a)}),!(this.errors.length||this.isAjax)){this.isAjax=!0,addClass(this.formBtn,"loading");var c=this.getFormData(a),d={method:this.method,body:c};request(this.url,d).then(function(){b.onSuccess(),b.clearForm()})["catch"](function(c){c.res.json().then(function(c){return b.onError(a,c)})})["finally"](function(){removeClass(b.formBtn,"loading"),b.isAjax=!1})}}},{key:"onSuccess",value:function onSuccess(){var a=this.options.result,b=a.isModal,c=a.redirectAddress,d=new Event("onFormSuccess");if(window.dispatchEvent(d),b)var e=new Modal({status:"success",title:this.message.success,btns:[{title:"\u0645\u062A\u0648\u062C\u0647 \u0634\u062F\u0645",variant:"outlined",color:"primary",onClick:function onClick(){return e.close()}}]});else window.location.href=c}},{key:"onError",value:function onError(a,b){var c=this,d=!1,e=function(){return b.errors&&Array.isArray(b.errors)&&c.message.error[b.errors[0]]?(b.errors[0]==c.messageType.CAE&&(d=!0),c.message.error[b.errors[0]]):c.message.error.general}(),f=d?[{title:"\u0641\u0647\u0645\u06CC\u062F\u0645",variant:"outlined",color:"primary",onClick:function onClick(){return g.close()}}]:[{title:"\u0627\u0646\u0635\u0631\u0627\u0641",variant:"outlined",color:"primary",onClick:function onClick(){return g.close()}},{title:"\u0627\u0631\u0633\u0627\u0644 \u0645\u062C\u062F\u062F",variant:"contained",color:"secondary",onClick:function onClick(){g.close(),c.onSubmit(a)}}],g=new Modal({status:"error",title:e,btns:f})}},{key:"removeError",value:function removeError(a){var b=this,c=a.getAttribute("name");this.errors.forEach(function(d,e){d==c&&(b.errors.splice(e,1),b.removeHint(a))})}},{key:"addHint",value:function addHint(a,b){var c=a.parentNode.querySelector(".form-hint");return c?void(c.innerHTML=b):void(c=document.createElement("span"),c.innerHTML=b,c.className="form-hint",a.parentNode.appendChild(c))}},{key:"removeHint",value:function removeHint(a){var b=a.parentNode.querySelector(".form-hint");b&&a.parentNode.removeChild(b)}},{key:"clearForm",value:function clearForm(){var a=this;this.inputs.forEach(function(b){b.value="",b.blur(),removeClass(b.parentNode,"form-field--error"),a.removeError(b)})}}]),a}();function initForms(){var a=document.querySelectorAll(".form");a.forEach(function(a){return new Form(a)})}function init(){initForms()}init();
